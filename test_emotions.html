<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoev3 Live2D è¡¨æƒ…æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .button-group {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .button-group h3 {
            margin-top: 0;
            color: #333;
        }
        button {
            margin: 5px;
            padding: 8px 15px;
            border: 1px solid #007bff;
            background-color: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .test-results {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #28a745;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        .log {
            margin: 10px 0;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .iframe-container {
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            height: 400px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <h1>ğŸ­ Zoev3 Live2D è¡¨æƒ…å’ŒåŠ¨ä½œæµ‹è¯•</h1>

    <div class="iframe-container">
        <iframe id="live2dFrame" src="src/display/live2d/index.html"></iframe>
    </div>

    <div class="button-group">
        <h3>ğŸ˜Š å°æ™ºAIæ ‡å‡†Emojiæµ‹è¯•</h3>
        <button onclick="testEmoji('ğŸ˜¶')">ğŸ˜¶ neutral</button>
        <button onclick="testEmoji('ğŸ™‚')">ğŸ™‚ happy</button>
        <button onclick="testEmoji('ğŸ˜†')">ğŸ˜† laughing</button>
        <button onclick="testEmoji('ğŸ˜‚')">ğŸ˜‚ funny</button>
        <button onclick="testEmoji('ğŸ˜”')">ğŸ˜” sad</button>
        <button onclick="testEmoji('ğŸ˜ ')">ğŸ˜  angry</button>
        <button onclick="testEmoji('ğŸ˜­')">ğŸ˜­ crying</button>
        <button onclick="testEmoji('ğŸ˜')">ğŸ˜ loving</button>
        <button onclick="testEmoji('ğŸ˜³')">ğŸ˜³ embarrassed</button>
        <button onclick="testEmoji('ğŸ˜²')">ğŸ˜² surprised</button>
        <button onclick="testEmoji('ğŸ˜±')">ğŸ˜± shocked</button>
    </div>

    <div class="button-group">
        <h3>ğŸ¯ æ›´å¤šEmojiæµ‹è¯•</h3>
        <button onclick="testEmoji('ğŸ¤”')">ğŸ¤” thinking</button>
        <button onclick="testEmoji('ğŸ˜‰')">ğŸ˜‰ winking</button>
        <button onclick="testEmoji('ğŸ˜')">ğŸ˜ cool</button>
        <button onclick="testEmoji('ğŸ˜Œ')">ğŸ˜Œ relaxed</button>
        <button onclick="testEmoji('ğŸ¤¤')">ğŸ¤¤ delicious</button>
        <button onclick="testEmoji('ğŸ˜˜')">ğŸ˜˜ kissy</button>
        <button onclick="testEmoji('ğŸ˜')">ğŸ˜ confident</button>
        <button onclick="testEmoji('ğŸ˜´')">ğŸ˜´ sleepy</button>
        <button onclick="testEmoji('ğŸ˜œ')">ğŸ˜œ silly</button>
        <button onclick="testEmoji('ğŸ™„')">ğŸ™„ confused</button>
    </div>

    <div class="button-group">
        <h3>ğŸ”„ æƒ…æ„Ÿåç§°æµ‹è¯•</h3>
        <button onclick="testEmotion('happy')">Happy</button>
        <button onclick="testEmotion('sad')">Sad</button>
        <button onclick="testEmotion('angry')">Angry</button>
        <button onclick="testEmotion('surprised')">Surprised</button>
        <button onclick="testEmotion('thinking')">Thinking</button>
        <button onclick="testEmotion('loving')">Loving</button>
        <button onclick="testEmotion('neutral')">Neutral</button>
    </div>

    <div class="button-group">
        <h3>ğŸ§ª æ¨¡æ‹Ÿå°æ™ºAIæ•°æ®æµ‹è¯•</h3>
        <button onclick="simulateAIResponse('ğŸ˜Š', 'happy')">æ¨¡æ‹Ÿå¼€å¿ƒå›å¤</button>
        <button onclick="simulateAIResponse('ğŸ˜”', 'sad')">æ¨¡æ‹Ÿæ‚²ä¼¤å›å¤</button>
        <button onclick="simulateAIResponse('ğŸ˜ ', 'angry')">æ¨¡æ‹Ÿç”Ÿæ°”å›å¤</button>
        <button onclick="simulateAIResponse('ğŸ˜²', 'surprised')">æ¨¡æ‹ŸæƒŠè®¶å›å¤</button>
        <button onclick="clearLogs()">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <div class="test-results">
        <h3>ğŸ“Š æµ‹è¯•ç»“æœ</h3>
        <div id="testLogs"></div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('testLogs');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            console.log(message);
        }

        function testEmoji(emoji) {
            log(`ğŸ¯ æµ‹è¯•Emoji: ${emoji}`);

            const iframe = document.getElementById('live2dFrame');
            if (iframe && iframe.contentWindow) {
                try {
                    // ç›´æ¥è°ƒç”¨iframeä¸­çš„å…¨å±€å‡½æ•°
                    if (iframe.contentWindow.playEmoji) {
                        iframe.contentWindow.playEmoji(emoji);
                        log(`âœ… Emoji ${emoji} å‘é€æˆåŠŸ`);
                    } else {
                        log(`âŒ iframeä¸­playEmojiå‡½æ•°ä¸å¯ç”¨`);
                    }
                } catch (error) {
                    log(`âŒ è°ƒç”¨å¤±è´¥: ${error.message}`);
                }
            } else {
                log(`âŒ iframeä¸å¯ç”¨`);
            }
        }

        function testEmotion(emotion) {
            log(`ğŸ­ æµ‹è¯•æƒ…æ„Ÿ: ${emotion}`);

            const iframe = document.getElementById('live2dFrame');
            if (iframe && iframe.contentWindow) {
                try {
                    if (iframe.contentWindow.playEmotion) {
                        iframe.contentWindow.playEmotion(emotion);
                        log(`âœ… æƒ…æ„Ÿ ${emotion} å‘é€æˆåŠŸ`);
                    } else {
                        log(`âŒ iframeä¸­playEmotionå‡½æ•°ä¸å¯ç”¨`);
                    }
                } catch (error) {
                    log(`âŒ è°ƒç”¨å¤±è´¥: ${error.message}`);
                }
            } else {
                log(`âŒ iframeä¸å¯ç”¨`);
            }
        }

        function simulateAIResponse(emoji, emotion) {
            log(`ğŸ¤– æ¨¡æ‹Ÿå°æ™ºAIå›å¤: emoji=${emoji}, emotion=${emotion}`);

            const data = {
                type: "llm",
                text: emoji,
                emotion: emotion
            };

            const iframe = document.getElementById('live2dFrame');
            if (iframe && iframe.contentWindow) {
                try {
                    // æ¨¡æ‹Ÿå‘é€æ¶ˆæ¯äº‹ä»¶
                    iframe.contentWindow.postMessage({
                        type: 'emotion',
                        emoji: emoji,
                        emotion: emotion,
                        data: data
                    }, '*');
                    log(`âœ… æ¨¡æ‹Ÿæ•°æ®å‘é€æˆåŠŸ: ${JSON.stringify(data)}`);
                } catch (error) {
                    log(`âŒ æ¨¡æ‹Ÿå‘é€å¤±è´¥: ${error.message}`);
                }
            }
        }

        function clearLogs() {
            document.getElementById('testLogs').innerHTML = '';
            log(`ğŸ§¹ æ—¥å¿—å·²æ¸…ç©º`);
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥iframeçŠ¶æ€
        window.addEventListener('load', function() {
            setTimeout(() => {
                log(`ğŸ” æ£€æŸ¥Live2D iframeçŠ¶æ€...`);
                const iframe = document.getElementById('live2dFrame');
                if (iframe && iframe.contentWindow) {
                    log(`âœ… iframeå·²åŠ è½½`);

                    // ç­‰å¾…Live2Dåˆå§‹åŒ–å®Œæˆ
                    setTimeout(() => {
                        if (iframe.contentWindow.live2dController) {
                            log(`âœ… Live2Dæ§åˆ¶å™¨å·²å°±ç»ª`);
                        } else {
                            log(`âš ï¸ Live2Dæ§åˆ¶å™¨æœªå°±ç»ªï¼Œè¯·ç­‰å¾…æ¨¡å‹åŠ è½½å®Œæˆ`);
                        }
                    }, 3000);
                } else {
                    log(`âŒ iframeæœªåŠ è½½`);
                }
            }, 1000);
        });

        // ç›‘å¬æ¥è‡ªiframeçš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'live2d_ready') {
                log(`âœ… Live2Då·²å‡†å¤‡å°±ç»ª`);
            }
        });
    </script>
</body>
</html>